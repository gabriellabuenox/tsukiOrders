<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pedido de Brigadeiros</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap">
  <style>
    :root{
      --brand:#ff6bb5;        /* rosa */
      --brand-2:#9b8cff;      /* roxo */
      --bg:#ffffff;           /* fundo branco */
      --card:#ffffff;
      --text:#2a2a2a;
      --muted:#7b8190;
      --border:#eee7f2;
      --ring:rgba(255,107,181,.25);
    }
    *{box-sizing:border-box}
    body{
      margin:0; background:var(--bg);
      font-family:Poppins, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial;
      color:var(--text);
    }
    .wrap{max-width:980px;margin:24px auto 96px;padding:0 16px}
    .header{
      display:flex; align-items:center; gap:14px; margin-bottom:14px;
      padding:8px 4px; border-radius:16px;
    }
    .logo{
      display:flex; align-items:center; gap:12px;
      background:linear-gradient(135deg, rgba(255,107,181,.10), rgba(155,140,255,.10));
      border:1px solid var(--border);
      padding:10px 14px; border-radius:14px;
      box-shadow:0 6px 20px rgba(0,0,0,.05);
    }
    .brand-title{font-weight:700; letter-spacing:.2px}
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:18px; padding:18px;
      box-shadow:0 8px 24px rgba(155,140,255,.08), 0 3px 12px rgba(255,107,181,.08);
    }
    h1{font-size:24px; margin:0 0 6px}
    h2{font-size:18px; margin:8px 0 10px}
    .muted{color:var(--muted); font-size:13px}
    .grid{display:grid; gap:12px}
    .grid-2{grid-template-columns:1fr 1fr}
    .row{display:grid; grid-template-columns:1fr; gap:10px}
    @media (min-width:760px){ .row.grid-2{grid-template-columns:1fr 1fr} }
    label{font-weight:600; font-size:14px}
    input[type="text"], input[type="date"], select{
      width:100%; padding:12px 14px; border:1px solid var(--border); border-radius:12px; font-size:15px; background:#fff;
      outline:none; transition: box-shadow .15s, border-color .15s, transform .04s;
    }
    input:focus, select:focus{ border-color:var(--brand); box-shadow:0 0 0 6px var(--ring) }
    input[type="number"]{ width:100%; max-width:95px }
    .section{ border:1px dashed var(--border); border-radius:14px; padding:12px; background:#fff }
    .inline{display:flex; align-items:center; gap:8px}
    .btn{
      appearance:none; border:1px solid var(--border); background:#fff; color:#333;
      border-radius:12px; padding:10px 14px; font-weight:600; cursor:pointer;
      transition: transform .06s ease, box-shadow .2s ease, border-color .2s ease;
    }
    .btn:hover{box-shadow:0 8px 18px rgba(155,140,255,.12)}
    .btn:active{transform:translateY(1px)}
    .btn.small{padding:8px 10px; border-radius:10px}
    .btn.primary{
      background:linear-gradient(135deg,var(--brand), var(--brand-2));
      border:none; color:#fff; box-shadow:0 10px 24px rgba(255,107,181,.22);
    }
    .item{border:1px solid var(--border); border-radius:14px; padding:12px; background:#fff}
    .item-header{display:flex; align-items:center; gap:10px; justify-content:space-between; margin-bottom:8px}
    .totals{
      display:flex; justify-content:space-between; align-items:center; gap:8px; flex-wrap:wrap;
      padding:12px; border:1px dashed var(--border); border-radius:14px; background:#fff;
      font-weight:700; margin-top:12px
    }
    .pill{padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:#fff; font-size:13px}
    pre{
      white-space:pre-wrap; background:#0f1225; color:#e6e9ff; padding:14px; border-radius:12px; font-size:13px; overflow:auto; margin-top:12px
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="logo">
        <!-- LOGO SVG embutida -->
        <div style="height:36px; width:auto">
          <svg xmlns="http://www.w3.org/2000/svg" width="144" height="36" viewBox="0 0 384 163" style="height:100%; width:auto;">
            <path fill="#34322F" d="M105.781.552c-3.86.318-9.526.708-12.6.948-12.442.943-21.895 4.172-39.38 13.23-13.546 7.088-20.395 13.072-32.213 28.119-9.687 12.365-14.49 19.844-17.562 27.25-2.36 5.672-4.49 19.213-3.938 25.203.552 5.906 2.917 15.438 4.094 16.537.474.395 1.89 2.364 3.15 4.333 1.261 1.969 3.074 4.411 4.022 5.51 1.02 1.104 2.755 3.703 3.86 5.912 1.968 3.541 5.744 7.557 10.234 10.63 1.026.63 3.229 2.203 4.963 3.464 2.047 1.421 5.276 2.598 8.583 3.229 2.995.552 7.328 1.656 9.688 2.364 2.364.709 7.01 1.657 10.24 2.125 3.229.396 6.302 1.026 6.692 1.417 1.026.87 13.547 2.604 14.495 1.974.39-.24 1.73 0 2.99.469 1.338.552 8.427.869 17.723.948 13.308 0 15.75-.162 17.563-1.339 1.969-1.26 2.281-1.26 8.661.708 5.276 1.651 8.271 2.125 14.73 2.125 12.052.078 16.619-1.104 23.864-5.984 1.651-1.182 3.703-2.047 4.646-2.047.948 0 4.49 1.339 7.953 3.068 3.469 1.656 8.271 3.469 10.636 4.021 2.359.547 6.38 1.968 8.979 3.229 2.521 1.177 5.12 1.969 5.666 1.729.552-.156 2.052.156 3.23.786 3.703 2.053 8.979 2.917 12.447 2.131 1.73-.396 4.568-.787 6.297-.787 2.839 0 15.912-3.859 22.605-6.62 1.578-.708 5.197-3.229 8.036-5.588 4.25-3.625 5.198-4.886 5.198-6.776 0-1.495-.396-2.281-1.182-2.281-1.183 0-5.12 3.541-5.12 4.645 0 .709-6.854 5.589-7.875 5.589-.474 0-1.417.318-2.209.713-2.125 1.099-9.447 2.599-10.312 2.125-.396-.317-1.974.235-3.469 1.105-2.359 1.416-3.703 1.573-9.291 1.26-7.719-.474-9.928-1.026-17.485-4.729-3.151-1.495-8.349-3.542-11.578-4.49-7.088-2.125-16.776-7.01-20.24-10.317-2.682-2.599-5.197-9.448-6.067-16.855-.469-3.619-.235-4.645 2.364-9.447 1.573-2.995 4.25-7.407 5.907-9.766 2.755-3.938 3.073-4.885 3.073-9.135 0-2.605.552-6.777 1.182-9.22.63-2.52 1.177-5.588 1.177-6.926 0-1.344 1.182-4.178 2.76-6.698 2.756-4.25 3.308-5.828 2.203-5.828-2.046.078-4.171 1.104-4.171 2.047 0 .63-.474 1.338-1.026 1.578-2.521.942-6.693 7.875-7.563 12.364-.469 2.443-1.26 5.276-1.807 6.302-.474.943-1.026 4.724-1.026 8.427-.157 6.537-.235 6.771-3.782 12.365-2.046 3.073-3.703 5.984-3.703 6.536 0 .474-.63 1.735-1.338 2.912-1.651 2.521-2.521 15.594-1.099 17.015.469.469.864 1.652.864 2.599 0 .943 1.105 3.068 2.443 4.724 2.359 3.073 2.359 3.073.708 4.412-.947.786-2.442 1.417-3.229 1.417-.786 0-3.463.708-5.906 1.656-3.703 1.416-5.359 1.573-10.396 1.099-12.682-1.099-16.776-3.308-24.495-13.229-1.968-2.443-2.286-7.563-1.182-16.146.63-4.49 1.417-8.667 1.734-9.136 1.099-1.416 5.667-13.703 5.667-15.047 0-.786.474-2.28 1.104-3.385 1.578-2.912 3.469-8.11 5.594-15.198 2.281-7.64 3.859-10.714 7.167-13.943 1.89-1.812 2.677-3.307 2.677-4.958 0-7.172 7.719-13.943 22.838-20.083 9.61-4.021 18.433-5.042 22.605-2.76 1.968 1.025 5.671-1.1 5.75-3.23.078-2.52-17.959-5.354-20.636-3.229-.552.396-3.307 1.578-6.141 2.599-2.838 1.026-5.828 2.286-6.697 2.917-.865.552-2.204 1.02-2.99 1.02-1.656 0-9.609 5.282-11.974 7.88-.865.943-2.99 2.678-4.646 3.699-3.073 1.968-3.073 1.968-7.953.63-5.672-1.495-8.115-1.339-9.375.552-1.021 1.734.87 3.937 5.516 6.224 2.125 1.02 3.463 2.203 3.463 2.99 0 1.89-5.984 16.775-7.01 17.328-.469.317-1.021 2.124-1.339 4.015-.786 5.36-2.359 10.87-4.567 16.307-3.542 8.662-5.907 14.412-5.907 14.803-.078.239-.078.947-.078 1.578 0 1.182-3.937 1.734-5.041.63-.943-1.026-6.381-2.599-11.105-3.386-2.599-.395-6.692-1.26-9.057-1.89-6.302-1.813-18.114-3.625-23.786-3.625-4.094 0-5.355.318-7.323 1.89-2.203 1.813-2.287 1.969-.787 2.443.865.313 2.282.865 3.151 1.339.787.474 4.016 1.182 7.089 1.573 2.99.395 8.031 1.026 11.026 1.416 7.557.948 10.552 1.657 11.104 2.443.234.396 1.573.708 2.912.708 3.072 0 8.192 1.417 17.484 4.729 1.422.547 1.578 1.339 1.656 9.136.234 13.073.156 12.995 1.734 12.755.865-.156 1.339.24 1.256 1.104-.078.787.317 1.417.869 1.417.553 0 1.735 1.26 2.678 2.76 1.656 2.834 1.656 2.834-8.428 2.36-12.364-.552-27.88-1.813-32.057-2.755-1.729-.318-5.432-.865-8.265-1.183-6.224-.63-16.386-3.151-20.792-5.041-4.886-2.204-7.64-3.068-11.266-3.62-3.62-.552-13.86-7.245-15.276-10.084-.552-.942-2.052-2.989-3.468-4.567-3.542-4.016-8.032-11.813-9.922-17.485-1.495-4.25-1.657-6.062-1.26-13.937.708-14.417 1.103-15.36 16.067-37.807.708-1.105 2.911-3.782 4.958-5.907 1.969-2.203 4.568-5.432 5.672-7.166 6.458-10.162 36.86-26.542 55.76-30.089 11.105-2.125 44.422-2.516 50.251-.625 2.046.625 5.828 1.417 8.427 1.651 2.599.318 6.692 1.104 9.057 1.735 2.364.63 5.75 1.416 7.479 1.812 1.734.39 4.651 1.099 6.542 1.651 2.515.708 3.62.708 4.25.078 1.968-1.969-2.443-6.458-6.38-6.458-.709 0-2.912-.787-4.881-1.73-4.885-2.442-9.843-3.702-14.729-3.78-2.364 0-5.276-.553-6.693-1.34C140.119.319 137.286.084 126.26 0c-7.323 0-16.536.24-20.479.552Z"/>
            <path fill="#34322F" d="M205.099 94.828c-.318.396-1.495.943-2.833 1.26-2.839.63-4.334 4.412-3.313 8.428.63 2.521.792 2.599 4.568 2.599 3.859 0 3.859 0 5.12-3.547.708-1.969 1.5-4.172 1.89-5.037.396-.87.318-2.047-.156-2.76-.865-1.417-4.568-2.125-5.276-.943Zm-23.313 4.802c0 .396.391.792.865.792.396 0 .552-.396.317-.792-.239-.468-.63-.786-.869-.786-.157 0-.313.318-.313.786Zm53.005 8.037c-2.995 1.495-3.307 1.968-3.547 5.12-.313 4.411.474 6.536 2.521 6.536 2.599 0 7.088-3.781 7.088-5.984 0-1.026.396-1.891.787-1.891 1.338 0 .87-2.839-.63-4.177-1.891-1.651-2.204-1.651-6.219.396Zm-30.088 17.244c-1.021.396-2.521.552-3.308.318-1.734-.552-2.677.865-1.182 1.734.87.469.948 1.417.474 4.016-.63 3.386-.552 3.464 2.047 4.568 1.417.63 3.151 1.104 3.781 1.104.63 0 1.261.469 1.417.943.318.786.786.786 2.521 0 1.182-.474 2.755-.943 3.547-.943 2.52 0 3.307-1.734 2.281-4.964-1.651-5.354-7.167-8.583-11.578-6.776Z"/>
          </svg>
        </div>
        <div class="brand-title">Pedidos — Brigadeiros</div>
      </div>
    </div>

    <div class="card">
      <h1>Montar pedido</h1>
      <p class="muted">Adicione <b>Caixinhas (4 unidades)</b> e/ou <b>Brigadeiros individuais</b>. Cada caixinha permite 4 sabores (1 por unidade). O individual tem 1 sabor e você define a quantidade.</p>

      <div class="grid row grid-2" style="margin:14px 0 12px">
        <div>
          <label for="clientName">Nome do cliente</label>
          <input id="clientName" type="text" placeholder="Ex.: João Silva" />
        </div>
        <div>
          <label for="deliveryDate">Data da entrega</label>
          <input id="deliveryDate" type="date" />
        </div>
      </div>

      <!-- CAIXINHAS -->
      <div class="section" id="boxSection">
        <div class="inline" style="justify-content:space-between; margin-bottom:8px">
          <h2>Caixinhas (4 unidades)</h2>
          <button id="addBox" class="btn small">+ Adicionar caixinha</button>
        </div>
        <div id="boxesList" class="grid"></div>
        <p class="muted" style="margin-top:6px">Dica: pode repetir sabores na mesma caixinha se quiser.</p>
      </div>

      <!-- INDIVIDUAIS -->
      <div class="section" id="singleSection" style="margin-top:12px">
        <div class="inline" style="justify-content:space-between; margin-bottom:8px">
          <h2>Brigadeiro individual</h2>
          <button id="addSingle" class="btn small">+ Adicionar individual</button>
        </div>
        <div id="singlesList" class="grid"></div>
      </div>

      <div class="totals">
        <div>Total de unidades: <span id="totalUnits">0</span></div>
        <div class="pill">Caixinhas: <span id="boxCount">0</span></div>
        <div class="pill">Individuais: <span id="singleCount">0</span></div>
      </div>

      <div style="margin-top:14px; display:flex; gap:10px; align-items:center">
        <button id="makeOrder" class="btn primary">Gerar Pedido</button>
        <span class="muted">Enviaremos para <b>+55 11 97313-3475</b></span>
      </div>

      <div id="outputWrap" style="display:none">
        <h2>Resumo</h2>
        <pre id="orderText"></pre>
      </div>
    </div>
  </div>

  <script>
    // ✅ Seu número fixo (apenas dígitos, sem +):
    const YOUR_WHATS_NUMBER = "5511973133475";

    const FLAVORS = [
      "Tradicional",
      "Ninho com Nutella",
      "Ninho com Uva",
      "Paçoca",
      "Beijinho",
      "Churros",
      "Bicho de Pé",
      "Casadinho",
      "Oreo"
    ];

    // Helpers
    const $ = (s)=>document.querySelector(s);
    const create = (tag, attrs={})=>{
      const el = document.createElement(tag);
      Object.entries(attrs).forEach(([k,v])=>{
        if(k==="class") el.className=v;
        else if(k==="text") el.textContent=v;
        else el.setAttribute(k,v);
      });
      return el;
    };
    const flavorSelect = ()=>{
      const sel = create("select");
      sel.appendChild(new Option("Selecione um sabor...", "", true, true));
      FLAVORS.forEach(f=> sel.appendChild(new Option(f, f)));
      return sel;
    };

    // Data padrão
    const todayISO = new Date().toISOString().slice(0,10);
    $("#deliveryDate").value = todayISO;

    // Persistir nome do cliente
    const nameInput = $("#clientName");
    nameInput.value = localStorage.getItem("brig_clientName") || "";
    nameInput.addEventListener("input", ()=> localStorage.setItem("brig_clientName", nameInput.value.trim()));

    const boxesList = $("#boxesList");
    const singlesList = $("#singlesList");
    const totalUnitsEl = $("#totalUnits");
    const boxCountEl = $("#boxCount");
    const singleCountEl = $("#singleCount");
    const outputWrap = $("#outputWrap");
    const orderTextPre = $("#orderText");

    // Adiciona uma CAIXINHA (4 sabores) + quantidade (padrão 1)
    function addBox(initial){
      const wrapper = create("div", {class:"item"});
      const header = create("div", {class:"item-header"});
      const title = create("div", {text:"Caixinha (4 unidades)"});
      const right = create("div", {class:"inline"});
      const qtyInput = create("input", {type:"number", min:"1", value:(initial?.qty||1)});
      const qtyLabel = create("span", {class:"muted", text:"Qtd."});
      const removeBtn = create("button", {class:"btn small", text:"Remover"});
      right.append(qtyLabel, qtyInput, removeBtn);
      header.append(title, right);

      const grid = create("div", {class:"grid grid-2"});
      const s1 = flavorSelect(), s2 = flavorSelect(), s3 = flavorSelect(), s4 = flavorSelect();
      if(initial?.flavors){ [s1,s2,s3,s4].forEach((s,i)=>{ s.value = initial.flavors[i] || ""; }); }
      grid.append(s1,s2,s3,s4);

      wrapper.append(header, grid);
      boxesList.append(wrapper);

      removeBtn.onclick = ()=>{ wrapper.remove(); recomputeTotals(); };
      [qtyInput,s1,s2,s3,s4].forEach(el=> el.addEventListener("change", recomputeTotals));
      recomputeTotals();
    }

    // Adiciona um INDIVIDUAL (1 sabor) + quantidade
    function addSingle(initial){
      const wrapper = create("div", {class:"item"});
      const header = create("div", {class:"item-header"});
      const title = create("div", {text:"Brigadeiro individual"});
      const right = create("div", {class:"inline"});
      const qtyInput = create("input", {type:"number", min:"1", value:(initial?.qty||1)});
      const qtyLabel = create("span", {class:"muted", text:"Qtd."});
      const removeBtn = create("button", {class:"btn small", text:"Remover"});
      right.append(qtyLabel, qtyInput, removeBtn);
      header.append(title, right);

      const sel = flavorSelect();
      if(initial?.flavor) sel.value = initial.flavor;

      wrapper.append(header, sel);
      singlesList.append(wrapper);

      removeBtn.onclick = ()=>{ wrapper.remove(); recomputeTotals(); };
      [qtyInput, sel].forEach(el=> el.addEventListener("change", recomputeTotals));
      recomputeTotals();
    }

    $("#addBox").onclick = ()=> addBox();
    $("#addSingle").onclick = ()=> addSingle();

    // Comece com 1 caixinha de exemplo
    addBox();

    function getBoxes(){
      return Array.from(boxesList.children).map(box=>{
        const qty = Math.max(1, parseInt(box.querySelector('input[type="number"]').value||"1",10));
        const selects = box.querySelectorAll("select");
        const flavors = Array.from(selects).map(s=> s.value).filter(Boolean);
        return { type:"box", qty, flavors };
      });
    }

    function getSingles(){
      return Array.from(singlesList.children).map(row=>{
        const qty = Math.max(1, parseInt(row.querySelector('input[type="number"]').value||"1",10));
        const flavor = row.querySelector("select").value || "";
        return { type:"single", qty, flavor };
      });
    }

    function recomputeTotals(){
      const boxes = getBoxes();
      const singles = getSingles();
      const boxUnits = boxes.reduce((s,b)=> s + b.qty * 4, 0);
      const singleUnits = singles.reduce((s,i)=> s + i.qty, 0);
      totalUnitsEl.textContent = boxUnits + singleUnits;
      boxCountEl.textContent = boxes.length;
      singleCountEl.textContent = singles.length;
    }

    function ddmmyyyy(iso){
      const [y,m,d] = (iso||"").split("-");
      return (y&&m&&d) ? `${d}/${m}/${y}` : "";
    }

    function buildOrder(){
      const clientName = $("#clientName").value.trim() || "(sem nome)";
      const deliveryDate = $("#deliveryDate").value || "";
      const boxes = getBoxes();
      const singles = getSingles();

      const items = [];
      boxes.forEach((b, idx)=>{
        items.push({ kind:"Caixinha (4 unidades)", index:idx+1, qty:b.qty, flavors:b.flavors });
      });
      singles.forEach((s, idx)=>{
        items.push({ kind:"Brigadeiro individual", index:idx+1, qty:s.qty, flavor:s.flavor });
      });

      const totalUnits = boxes.reduce((sum,b)=> sum + b.qty*4, 0) + singles.reduce((sum,i)=> sum + i.qty, 0);

      return {
        clientName,
        deliveryDate,
        deliveryDate_br: ddmmyyyy(deliveryDate),
        boxes, singles, items, totalUnits
      };
    }

    function toText(order){
      const header =
`Pedido de Brigadeiros
Cliente: ${order.clientName}
Data da entrega: ${order.deliveryDate_br || "-"}

`;
      const boxLines = order.boxes.length
        ? order.boxes.map((b,i)=>{
            const list = (b.flavors && b.flavors.length) ? b.flavors.join(", ") : "-";
            return `Caixinha ${i+1} (4 unidades): sabores [${list}] — Qtd: ${b.qty} (unid: ${b.qty*4})`;
          }).join("\n")
        : "(sem caixinhas)";

      const singleLines = order.singles.length
        ? order.singles.map((s,i)=> `Individual ${i+1}: ${s.flavor||"-"} — Qtd: ${s.qty}`).join("\n")
        : "(sem individuais)";

      const total = `\nTotal de unidades: ${order.totalUnits}`;
      return `${header}Caixinhas:\n${boxLines}\n\nIndividuais:\n${singleLines}${total}`;
    }

    $("#makeOrder").addEventListener("click", ()=>{
      const order = buildOrder();
      if(order.boxes.length===0 && order.singles.length===0){
        alert("Adicione ao menos 1 caixinha ou 1 individual.");
        return;
      }
      const text = toText(order);
      $("#orderText").textContent = text;
      $("#outputWrap").style.display = "block";

      // Abre WhatsApp
      const url = `https://wa.me/${YOUR_WHATS_NUMBER}?text=${encodeURIComponent(text)}`;
      window.open(url, "_blank");
    });
  </script>
</body>
</html>
